<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="MovieExplorer.MainPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Movie Explorer">

    <Grid Padding="12" RowDefinitions="Auto,Auto,*" RowSpacing="10">

        <Label Text="🎬 Movie Explorer"
               FontSize="24"
               HorizontalOptions="Center"
               TextColor="{DynamicResource PrimaryTextColor}" />

        <Grid Grid.Row="1" ColumnDefinitions="*,160,160" ColumnSpacing="10">
            <Entry x:Name="SearchEntry"
                   Grid.Column="0"
                   Placeholder="Search by title..."
                   TextChanged="OnSearchChanged"
                   BackgroundColor="{DynamicResource InputBackgroundColor}"
                   TextColor="{DynamicResource InputTextColor}"
                   PlaceholderColor="{DynamicResource PlaceholderTextColor}" />

            <VerticalStackLayout Grid.Column="1" Spacing="4">
                <Label Text="Genre"
                       FontSize="12"
                       TextColor="{DynamicResource SecondaryTextColor}" />

                <Picker x:Name="GenrePicker"
                        Title="All"
                        SelectedIndexChanged="OnGenreChanged"
                        BackgroundColor="{DynamicResource InputBackgroundColor}"
                        TextColor="{DynamicResource InputTextColor}" />
            </VerticalStackLayout>

            <VerticalStackLayout Grid.Column="2" Spacing="4">
                <Label Text="Sort"
                       FontSize="12"
                       TextColor="{DynamicResource SecondaryTextColor}" />

                <Picker x:Name="SortPicker"
                        Title="Title A-Z"
                        SelectedIndexChanged="OnSortChanged"
                        BackgroundColor="{DynamicResource InputBackgroundColor}"
                        TextColor="{DynamicResource InputTextColor}" />
            </VerticalStackLayout>
        </Grid>

        <CollectionView x:Name="MoviesView"
                        Grid.Row="2"
                        BackgroundColor="{DynamicResource PageBackgroundColor}"
                        SelectionMode="Single"
                        SelectionChanged="OnMovieSelected">

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Padding="10"
                            Margin="5"
                            BackgroundColor="{DynamicResource CardBackgroundColor}"
                            Stroke="Transparent"
                            StrokeThickness="1">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12" />
                        </Border.StrokeShape>

                        <HorizontalStackLayout Spacing="12">
                            <Label Text="{Binding Emoji}"
                                   FontSize="28" />

                            <VerticalStackLayout>
                                <Label Text="{Binding Title}"
                                       FontAttributes="Bold"
                                       TextColor="{DynamicResource PrimaryTextColor}" />

                                <Label Text="{Binding Year}"
                                       FontSize="12"
                                       TextColor="{DynamicResource SecondaryTextColor}" />

                                <Label Text="{Binding GenresDisplay}"
                                       FontSize="12"
                                       TextColor="{DynamicResource SecondaryTextColor}" />
                            </VerticalStackLayout>
                        </HorizontalStackLayout>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </Grid>
</ContentPage>
